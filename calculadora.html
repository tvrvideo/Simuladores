<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="theme-color" content="#0a0f1c" />
  <title>Tensor muelles v2</title>

  <style>
    :root{
      --bg0:#050711;
      --bg1:#0a0f1c;
      --card:#0e1630;
      --border: rgba(255,255,255,.10);
      --text:#eef3ff;
      --muted: rgba(238,243,255,.72);
      --shadow: 0 18px 44px rgba(0,0,0,.45);
      --radius: 18px;

      /* Inputs crema/amarillo */
      --inputBg: #fff1c2;
      --inputBg2:#ffe7a0;
      --inputText:#131a2a;
      --focus: rgba(255, 214, 102, .35);

      /* Destacado vueltas */
      --accent: #6ee7ff;
      --accent2:#a78bfa;
    }

    *{ box-sizing:border-box; }
    html, body { height:100%; }
    body{
      margin:0;
      font-family: -apple-system, BlinkMacSystemFont, "SF Pro Text", Segoe UI, Roboto, Helvetica, Arial, sans-serif;
      color: var(--text);
      background:
        radial-gradient(900px 520px at 20% 10%, rgba(114, 214, 255, .14), transparent 58%),
        radial-gradient(800px 480px at 85% 20%, rgba(167, 139, 250, .12), transparent 60%),
        linear-gradient(180deg, var(--bg0), var(--bg1));
      padding: env(safe-area-inset-top) 16px env(safe-area-inset-bottom);
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
      -webkit-text-size-adjust: 100%;
      touch-action: manipulation;
    }

    .wrap{
      max-width: 680px;
      margin: 0 auto;
      padding: 20px 6px 28px;
    }

    .title{
      font-size: 20px;
      font-weight: 900;
      letter-spacing: .2px;
      margin: 4px 6px 14px;
    }

    .card{
      background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.02));
      border: 1px solid var(--border);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      overflow:hidden;
    }

    .inner{
      padding: 16px;
    }

    .grid{
      display:grid;
      grid-template-columns: 1fr;
      gap: 12px;
    }

    @media (min-width: 560px){
      .grid{ grid-template-columns: 1fr 1fr; }
    }

    .field{
      border: 1px solid var(--border);
      border-radius: 14px;
      padding: 12px;
      background: rgba(0,0,0,.10);
    }

    label{
      display:block;
      font-weight: 800;
      font-size: 13px;
      letter-spacing: .15px;
      margin-bottom: 8px;
      color: var(--muted);
    }

    input[type="number"]{
      width: 100%;
      border-radius: 12px;
      border: 1px solid transparent;
      background: linear-gradient(180deg, var(--inputBg), var(--inputBg2));
      color: var(--inputText);
      padding: 12px 12px;
      font-size: 18px; /* >=16 para iOS */
      font-weight: 800;
      outline:none;
      -webkit-appearance: none;
      appearance:none;
      touch-action: manipulation;
      box-shadow: inset 0 0 0 1px rgba(0,0,0,.10);
    }

    input[type="number"]:focus{
      box-shadow: inset 0 0 0 1px rgba(255,214,102,.55), 0 0 0 3px var(--focus);
    }

    .result{
      margin-top: 14px;
      border-top: 1px solid var(--border);
      padding: 14px 16px 16px;
      text-align:center;
    }

    .resultLabel{
      margin: 0 0 8px;
      font-size: 12.5px;
      color: var(--muted);
      letter-spacing:.2px;
    }

    .resultRow{
      display:flex;
      justify-content:center;
      align-items:baseline;
      gap: 14px;
      flex-wrap: wrap;
    }

    .vueltas{
      display:inline-flex;
      align-items:baseline;
      gap:8px;
      padding: 10px 14px;
      border-radius: 14px;
      border: 1px solid rgba(110,231,255,.22);
      background:
        radial-gradient(220px 120px at 30% 20%, rgba(110,231,255,.18), transparent 60%),
        linear-gradient(135deg, rgba(110,231,255,.12), rgba(167,139,250,.10));
    }

    .vueltas .num{
      font-size: 42px;
      font-weight: 950;
      letter-spacing:.4px;
      line-height: 1;
    }

    .vueltas .unit{
      font-size: 14px;
      font-weight: 800;
      color: var(--muted);
    }

    .circ{
      padding: 10px 12px;
      border-radius: 14px;
      border: 1px solid var(--border);
      background: rgba(0,0,0,.10);
      color: var(--muted);
      font-weight: 800;
      font-size: 13px;
      letter-spacing:.2px;
    }

    .circ strong{
      color: var(--text);
      font-weight: 950;
    }

    .error{
      color: #fb7185;
      font-weight: 900;
    }

    .sr-only{
      position:absolute !important;
      width:1px; height:1px;
      padding:0; margin:-1px;
      overflow:hidden; clip:rect(0,0,0,0);
      white-space:nowrap; border:0;
    }
  </style>
</head>

<body>
  <main class="wrap">
    <div class="title">Tensor muelles v2</div>

    <section class="card" aria-label="Calculadora">
      <div class="inner">
        <div class="grid">
          <div class="field">
            <label for="alto">Altura de la cortina (mm)</label>
            <input id="alto" type="number" inputmode="decimal" min="1" step="1" value="1400" aria-describedby="ayudaAlto" />
            <div id="ayudaAlto" class="sr-only">Introduce la altura en milímetros.</div>
          </div>

          <div class="field">
            <label for="eje">Diámetro del eje (mm)</label>
            <input id="eje" type="number" inputmode="decimal" min="1" step="1" value="25" aria-describedby="ayudaEje" />
            <div id="ayudaEje" class="sr-only">Introduce el diámetro del eje en milímetros.</div>
          </div>

          <div class="field" style="grid-column: 1 / -1;">
            <label for="pretension">Vueltas pretensión</label>
            <input id="pretension" type="number" inputmode="decimal" min="0" step="1" value="7" aria-describedby="ayudaPre" />
            <div id="ayudaPre" class="sr-only">Introduce las vueltas de pretensión.</div>
          </div>
        </div>
      </div>

      <div class="result" role="status" aria-live="polite">
        <p class="resultLabel">Resultado</p>

        <div class="resultRow" id="resultRow">
          <div class="vueltas" aria-label="Vueltas recomendadas">
            <span class="num" id="vueltasNum">—</span>
            <span class="unit">vueltas</span>
          </div>

          <div class="circ" aria-label="Circunferencia">
            Circunferencia: <strong id="circVal">—</strong> mm
          </div>
        </div>

        <div id="errorBox" class="error" style="display:none; margin-top:10px;">
          Introduce valores válidos
        </div>
      </div>
    </section>
  </main>

  <script>
    (function () {
      "use strict";

      const $alto = document.getElementById("alto");
      const $eje = document.getElementById("eje");
      const $pret = document.getElementById("pretension");

      const $vueltasNum = document.getElementById("vueltasNum");
      const $circVal = document.getElementById("circVal");
      const $errorBox = document.getElementById("errorBox");

      function toNumber(v) {
        const n = Number(String(v).replace(",", "."));
        return Number.isFinite(n) ? n : NaN;
      }

      function fmt(n, digits) {
        return Number.isFinite(n) ? n.toFixed(digits) : "—";
      }

      function setError(on) {
        $errorBox.style.display = on ? "block" : "none";
      }

      function calcular() {
        const alto = toNumber($alto.value);      // mm
        const eje  = toNumber($eje.value);       // mm
        const pre  = toNumber($pret.value);      // vueltas

        if (!(alto > 0) || !(eje > 0) || !(pre >= 0)) {
          setError(true);
          $vueltasNum.textContent = "—";
          $circVal.textContent = "—";
          return;
        }

        setError(false);

        // Circunferencia en mm
        const circ = Math.PI * eje;

        // Vueltas = recorrido (mm / mm) + pretensión
        const recorrido = alto / circ;
        const vueltas = Math.ceil(recorrido) + Math.round(pre);

        $vueltasNum.textContent = String(vueltas);
        $circVal.textContent = fmt(circ, 2);
      }

      // iOS/WebView friendly listeners
      ["input","change"].forEach(evt => {
        $alto.addEventListener(evt, calcular, { passive: true });
        $eje.addEventListener(evt, calcular, { passive: true });
        $pret.addEventListener(evt, calcular, { passive: true });
      });

      calcular();
    })();
  </script>
</body>
</html>
